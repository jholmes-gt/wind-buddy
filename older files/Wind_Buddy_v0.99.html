<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Wind-Buddy</title>
<style>
:root{
  --bg:#f8f9fb;
  --card:#ffffff;
  --muted:#6b7280;
  --accent:#626a69;
  --yellow:#ffeb8b;
  --border:#e6e9ef;
  --radius:10px;
  --gap:12px;
}
*{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;}
body{margin:0;background:var(--bg);color:#111;padding:16px;display:flex;justify-content:center;}
.app{width:100%;max-width:1300px;display:flex;flex-direction:column;gap:var(--gap);}

/* Club categories section */
.club-section{display:flex;gap:8px;flex-wrap:nowrap;overflow-x:auto;}
.category{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:6px 8px;flex:1;min-width:150px;}
.category h3{text-align:center;font-size:13px;margin:2px 0 6px 0;text-transform:uppercase;color:#333;}
.club-list{display:flex;flex-direction:column;gap:4px;}
.club-item{display:flex;align-items:center;gap:6px;justify-content:space-between;}
.club-radio{appearance:none;width:14px;height:14px;border:1px solid var(--border);border-radius:3px;cursor:pointer;position:relative;}
.club-radio:checked::after{content:'';position:absolute;inset:2px;background:var(--accent);border-radius:2px;}
.levels{display:flex;flex-wrap:wrap;gap:4px;margin-top:4px;}
.level-btn{width:28px;height:24px;border:1px solid var(--border);border-radius:4px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:12px;background:#fff;}
.level-btn.disabled{opacity:0.4;cursor:not-allowed;}
.level-btn.selected{background:var(--accent);color:#fff;border-color:var(--accent);}

/* Controls + ring card */
.controls-bar{display:flex;align-items:center;justify-content:center;gap:20px;background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:12px 16px;flex-wrap:wrap;}
.control-col{display:flex;flex-direction:column;gap:6px;align-items:center;}
.control-col label{font-size:12px;color:var(--muted);}
input[type="number"], select{padding:6px 8px;border:1px solid var(--border);border-radius:6px;width:70px;}
input[type="range"]{width:180px;}
.rings-card{background:var(--yellow);border:2px solid #e3c85b;border-radius:10px;padding:12px 16px;min-width:200px;box-shadow:0 4px 10px rgba(0,0,0,0.05);}
.rings-big{font-size:30px;font-weight:800;color:#111;text-align:center;}
.rings-small{font-size:12px;text-align:center;margin-top:4px;}
.active-club{text-align:center;margin-top:6px;font-size:13px;font-weight:600;color:#222;}

/* Shortcut buttons below controls */
.shortcut-bar{display:flex;justify-content:center;gap:8px;flex-wrap:wrap;}
.shortcut-btn{
  border:1px solid var(--border);
  border-radius:6px;
  padding:6px 12px;
  font-size:13px;
  background:#f2f2f2;
  color:#666;
  cursor:not-allowed;
  transition:all 0.2s ease;
}
.shortcut-btn.enabled{cursor:pointer;background:#fff;color:#222;}
.shortcut-btn.enabled:hover{background:#e6e6e6;}
.shortcut-btn.active{background:var(--accent);color:#fff;border-color:var(--accent);}

/* Footer */
.footer-note{text-align:center;font-size:12px;color:var(--muted);margin-top:10px;}
</style>
</head>
<body>
<div class="app">

  <!-- Hide/Show Clubs link -->
  <div style="text-align:right;font-size:13px;">
    <a href="#" id="toggleClubs" style="color:#228b22;text-decoration:none;">Hide Clubs ▲</a>
  </div>

  <!-- Club Categories -->
  <div class="club-section" id="clubSection"></div>

  <!-- Controls + Rings Card -->
  <div class="controls-bar">
    <div class="control-col">
      <label>Wind (mph)</label>
      <input id="wind" type="number" step="0.1" value="0.0" />
      <label>Ball Power</label>
      <select id="ball_power">
        <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
        <option selected>6</option><option>7</option><option>8</option><option>9</option><option>10</option>
      </select>
      <label>Club Distance (%)</label>
      <input id="club_distance" type="range" min="0" max="100" value="100" />
      <label>Elevation (%)</label>
      <input id="elevation" list="elevList" type="number" value="10" />
      <datalist id="elevList">
        <option value="-65"><option value="-60"><option value="-55"><option value="-50"><option value="-45">
        <option value="-40"><option value="-35"><option value="-30"><option value="-25"><option value="-20">
        <option value="-15"><option value="-10"><option value="-5"><option value="0"><option value="5">
        <option value="10"><option value="15"><option value="20"><option value="25"><option value="30">
        <option value="35"><option value="40"><option value="45"><option value="50"><option value="55">
        <option value="60"><option value="65">
      </datalist>
    </div>

    <div class="rings-card">
      <div class="rings-big" id="rings_main">--</div>
      <div class="rings-small">
        Max: <span id="r_max">--</span> | Mid: <span id="r_mid">--</span> | Min: <span id="r_min">--</span><br>
        75%: <span id="r_75">--</span> | 25%: <span id="r_25">--</span>
      </div>
      <div class="active-club" id="active_club">No selection</div>
    </div>
  </div>

  <!-- Shortcut Buttons -->
  <div class="shortcut-bar" id="shortcutBar"></div>

  <div class="footer-note">© 2025 Wind-Buddy by Justin Holmes. Inspired by the late great Wind Chum. May it rest in peace.</div>
</div>

<script>
/* ---- Club Data (small demo set) ---- */
const clubCats = {
  Drivers: ["Rocket","Extra_Mile","Apocalypse"],
  Woods: ["Viper","Guardian","Cataclysm"],
  Long_Irons: ["Grim_Reaper","B52","Grizzly"],
  Short_Irons: ["Thorn","Hornet","Falcon"],
  Wedges: ["Dart","Endbringer","Rapier"],
  Rough_Irons: ["Roughcutter","Off_Roader","Nirvana"],
  Sand_Wedges: ["Malibu","Houdini","Spitfire"]
};
const epics = new Set(["Apocalypse","Cataclysm","B52","Falcon","Endbringer","Off_Roader","Houdini","Spitfire"]);
const rares = new Set(["Extra_Mile","Guardian","Grizzly","Thorn","Hornet","Rapier","Nirvana","Malibu"]);
const windData = {Drivers:{Rocket:{1:"2|2|2"},Extra_Mile:{1:"2|2|2"},Apocalypse:{1:"2|2|2"}}};

/* ---- State ---- */
let state = {selected:{},activeCategory:null};
const clubSection=document.getElementById('clubSection');
const shortcutBar=document.getElementById('shortcutBar');
const activeClubLabel=document.getElementById('active_club');
const ringsMain=document.getElementById('rings_main');
const r_max=document.getElementById('r_max'),r_mid=document.getElementById('r_mid'),
r_min=document.getElementById('r_min'),r_25=document.getElementById('r_25'),r_75=document.getElementById('r_75');

/* ---- Build Club Panels ---- */
Object.keys(clubCats).forEach(cat=>{
  const box=document.createElement('div');
  box.className='category';
  const title=document.createElement('h3');
  title.textContent=cat.replace(/_/g,' ');
  box.appendChild(title);
  const list=document.createElement('div');list.className='club-list';
  clubCats[cat].forEach(club=>{
    const item=document.createElement('div');item.className='club-item';
    const r=document.createElement('input');r.type='radio';r.name=`club_${cat}`;r.className='club-radio';r.value=club;
    r.addEventListener('change',()=>{selectClub(cat,club);});
    const l=document.createElement('span');l.textContent=club.replace(/_/g,' ');
    item.append(r,l);list.appendChild(item);
  });
  box.appendChild(list);
  const lv=document.createElement('div');lv.className='levels';
  for(let i=1;i<=10;i++){
    const b=document.createElement('div');b.className='level-btn';b.textContent=i;b.dataset.cat=cat;b.dataset.level=i;
    b.addEventListener('click',()=>{if(b.classList.contains('disabled'))return;selectLevel(cat,i);});
    lv.appendChild(b);
  }
  box.appendChild(lv);
  clubSection.appendChild(box);
});

/* ---- Shortcut Buttons ---- */
Object.keys(clubCats).forEach(cat=>{
  const btn=document.createElement('div');
  btn.className='shortcut-btn';
  btn.textContent=cat.replace(/_/g,' ');
  btn.dataset.cat=cat;
  btn.addEventListener('click',()=>{
    if(!btn.classList.contains('enabled'))return;
    setActiveCategory(cat);
  });
  shortcutBar.appendChild(btn);
});
function updateShortcut(cat){
  const btn=document.querySelector(`.shortcut-btn[data-cat="${cat}"]`);
  const sel=state.selected[cat];
  if(sel && sel.club && sel.level){
    btn.classList.add('enabled');
    btn.textContent=`${sel.club.replace(/_/g,' ')} (Lvl ${sel.level})`;
  }else{
    btn.classList.remove('enabled','active');
    btn.textContent=cat.replace(/_/g,' ');
  }
}

/* ---- Club/Level Selection ---- */
function selectClub(cat,club){
  state.selected[cat]=state.selected[cat]||{};
  state.selected[cat].club=club;
  refreshLevels(cat);
  updateShortcut(cat);
  triggerCalcIfReady(cat);
}
function selectLevel(cat,level){
  state.selected[cat]=state.selected[cat]||{};
  state.selected[cat].level=level;
  document.querySelectorAll(`.level-btn[data-cat="${cat}"]`).forEach(b=>b.classList.remove('selected'));
  document.querySelector(`.level-btn[data-cat="${cat}"][data-level="${level}"]`).classList.add('selected');
  refreshLevels(cat);
  updateShortcut(cat);
  triggerCalcIfReady(cat);
}

/* ---- Enable/Disable Levels ---- */
function refreshLevels(cat){
  const club=state.selected[cat]?.club;
  document.querySelectorAll(`.level-btn[data-cat="${cat}"]`).forEach(b=>b.classList.remove('disabled'));
  if(!club)return;
  if(epics.has(club)){
    document.querySelectorAll(`.level-btn[data-cat="${cat}"]`).forEach(b=>{if(b.dataset.level>8)b.classList.add('disabled');});
  }else if(rares.has(club)){
    document.querySelectorAll(`.level-btn[data-cat="${cat}"]`).forEach(b=>{if(b.dataset.level>9)b.classList.add('disabled');});
  }
}

/* ---- Active Category ---- */
function setActiveCategory(cat){
  document.querySelectorAll('.shortcut-btn').forEach(x=>x.classList.remove('active'));
  const btn=document.querySelector(`.shortcut-btn[data-cat="${cat}"]`);
  if(btn)btn.classList.add('active');
  state.activeCategory=cat;
  triggerCalcIfReady(cat);
}

/* ---- Calculation ---- */
function triggerCalcIfReady(cat){
  const sel=state.selected[cat];
  if(!sel||!sel.club||!sel.level)return;
  const wind=parseFloat(document.getElementById('wind').value)||0;
  const elevation=parseFloat(document.getElementById('elevation').value)||0;
  const ball_power=parseInt(document.getElementById('ball_power').value)||6;
  const club_distance=parseFloat(document.getElementById('club_distance').value)||100;
  const val="2|2|2";
  const arr=val.split('|').map(parseFloat);
  const adj=(ball_power<6)?1-(0.0119*(6-ball_power)):1+(0.0119*(ball_power-6));
  const multiplier=(1+elevation/100)*adj;
  const max_r=round((wind/arr[0])*multiplier,1);
  const mid_r=round((wind/arr[1])*multiplier,1);
  const min_r=round((wind/arr[2])*multiplier,1);
  const r25=round((min_r+mid_r)/2,1),r75=round((max_r+mid_r)/2,1);
  let minAct,min25;
  if(["Wedges","Rough_Irons","Sand_Wedges"].includes(cat)){minAct=0;min25=round(max_r*0.25,1);}else{minAct=min_r;min25=r25;}
  const diff=max_r-minAct;
  const trueRing=round(minAct+(diff*(club_distance/100)),1);
  setRingsDisplay(trueRing,max_r,mid_r,min_r,min25,r75,sel.club,sel.level);
}
function setRingsDisplay(main,max,mid,min,p25,p75,club,level){
  ringsMain.textContent=main;
  r_max.textContent=max;r_mid.textContent=mid;r_min.textContent=min;r_25.textContent=p25;r_75.textContent=p75;
  activeClubLabel.textContent=club?`${club.replace(/_/g,' ')} (Lvl ${level})`:"No selection";
}
function round(n,d){const f=Math.pow(10,d);return Math.round(n*f)/f;}

/* ---- Wind field special logic ---- */
document.getElementById('wind').addEventListener('change',e=>{
  const val=e.target.value;
  if(!val.includes('.')){
    const newVal=(parseInt(val)/10).toFixed(1);
    e.target.value=newVal;
  }
  Object.keys(state.selected).forEach(cat=>triggerCalcIfReady(cat));
});

/* ---- Elevation/other listeners ---- */
["elevation","ball_power","club_distance"].forEach(id=>{
  document.getElementById(id).addEventListener('input',()=>{
    Object.keys(state.selected).forEach(cat=>triggerCalcIfReady(cat));
  });
});

/* ---- Hide/Show Clubs ---- */
const toggle=document.getElementById('toggleClubs');
toggle.addEventListener('click',e=>{
  e.preventDefault();
  const section=document.getElementById('clubSection');
  const hidden=section.style.display==='none';
  section.style.display=hidden?'flex':'none';
  toggle.textContent=(hidden?'Hide':'Show')+' Clubs ▲';
});

/* ---- Init ---- */
Object.keys(clubCats).forEach(cat=>updateShortcut(cat));
</script>
</body>
</html>
